You are a Senior Full-Stack Software Engineer specializing in secure POS system development.

Objective:
Execute **Phase 2: Security & Data Integrity** from the ClassicPOS Fix Roadmap.
Upgrade ClassicPOS authentication, database relationships, and error handling for a production-ready deployment.

ğŸŸ¢ SYSTEM CONTEXT:
- Project: ClassicPOS
- Backend: Node.js (Express)
- Frontend: React + TypeScript (Vite)
- Database: SQLite (classicpos.db, offline + embedded for Android)
- Auth System: JWT + bcrypt + PIN-based secondary access
- Test Stack: Jest + Supertest (backend), React Testing Library (frontend)

---

### ğŸ¯ PHASE 2 TASKS

#### 1ï¸âƒ£ Security Hardening (SEC-001 to SEC-003)
ğŸŸ¥ **SEC-001: Encrypt MFA Backup Codes**
- Current Issue: Backup codes stored in plain text.
- Fix: Hash all backup codes using bcrypt before saving.
- Update: Regenerate codes for existing users, hash on save.
- Test: Verify backup codes unreadable in database.

ğŸŸ¥ **SEC-002: Implement Session Revocation / Token Invalidation**
- Add token blacklist table or in-memory cache (e.g., revoked_tokens).
- Add logout endpoint to revoke JWT token.
- Middleware: Block blacklisted tokens from further access.
- Test:
  âœ… Valid token â†’ access granted
  âŒ Revoked token â†’ access denied (401)

ğŸŸ¥ **SEC-003: Enforce Password Complexity Policy**
- Rule: Minimum 8 characters, at least 1 uppercase, 1 lowercase, 1 number, and 1 special symbol.
- Add regex validation in `createUserSchema` (backend/utils/validation.cjs).
- Test: Weak password â†’ rejected with 400.

---

#### 2ï¸âƒ£ Data Integrity (DB-002, DB-003)
ğŸŸ§ **DB-002: Implement Cascading Deletes or Dependency Checks**
- Add dependency checks before deleting any parent record:
  â€¢ Deleting a supplier checks linked purchase orders.
  â€¢ Deleting a customer checks linked sales.
- Option: Add `ON DELETE CASCADE` where logical.
- Test: Verify dependent records are either blocked or deleted safely.

ğŸŸ§ **DB-003: Stock Reversal on Inventory Document Deletion**
- On deleting GRN, Stock Adjustment, or Transfer:
  â†’ Reverse associated stock movements.
  â†’ Adjust stock counts in products table.
- Prevent deletion of "approved" documents if reversal logic fails.
- Test:
  âœ… Delete pending GRN â†’ OK, stock reversed.
  âŒ Delete approved GRN â†’ 400, blocked.

---

#### 3ï¸âƒ£ Error Handling & Sanitization (ERR-002)
- Sanitize all backend error messages.
- Replace raw SQLite errors (e.g., â€œNOT NULL constraint failedâ€) with safe responses:
  Example:
  ```js
  res.status(400).json({ error: "Invalid or incomplete data provided." });
